<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
		<link rel="stylesheet" href="/static/style.css">

		<script src="/static/handlebars-v2.0.0.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	</head>

	<body>

		<!-- Nav -->
		<nav style="display:none;" class="row-fluid navbar navbar-fixed-top" role="navigation">

			<div class="container">

				<div class="row">
					
					<form id="form-sub" role="form">
						<div class="col-xs-2 col-md-1 homelink">
							<a href="/"><span class="glyphicon glyphicon-home"></span></a>
						</div>

						<div class="col-xs-2 col-md-1">
							<button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-search"></span></button>
						</div>
						<div class="col-xs-4 col-md-2">
							<select id="select-sort" class="form-control">
							    <option selected="selected" value="hot">hot</option>
							    <option value="new">new</option>
							    <option value="day">top today</option>
							    <option value="week">top this week</option>
							    <option value="month">top this month</option>
							    <option value="year">top this year</option>]
							    <option value="all">top all time</option>
							</select>
						</div>
					</form>
					<div class="col-xs-0 col-md-2"></div>
				</div>
			</div>
		</nav>

		<!-- Grid -->
		<div id="main" class="container-fluid">
			<div class="row">
				<div id="left-menu" class="col-xs-2">
				 <div class="row">
				 	<div class="col-xs-12">
						<input type="input" class="form-control" id="input-sub" placeholder="Enter a Subreddit">
					</div>
				 </div>
				 <div class="row">
				 	<div id="sub-list" class="col-xs-12">
						
					</div>
				 </div>
				</div>
				<div id="gallery" class="col-xs-10">
					<div class="row">
						<div id="col-1" class='col-xs-3'></div>
						<div id="col-2" class='col-xs-3'></div>
						<div id="col-3" class='col-xs-3'></div>
						<div id="col-4" class='col-xs-3'></div>
					</div>
				</div>
			</div>
		</div>

		<!--Start Google Analytics-->

		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		  ga('create', 'UA-53022536-1', 'auto');
		  ga('require', 'displayfeatures');
		  ga('send', 'pageview');
		</script>

	</body>

</html>

{% raw %}

 <script id="simple-template" type="text/x-handlebars-template">

	<div class="picbox">
		<a style="{{thumbnailHelper}}" target="_blank" href="{{data.url}}"><img src="{{{picHelper data}}}" /></a>
		<div class="col-xs-12 {{data.display}}" >

			<div class="row">
				<div class="col-xs-12">
					<a id="extlink" href="http://www.reddit.com/{{data.permalink}}" target="_blank">{{formatTitle data}}</a>
				</div>
			</div>

			<div class="row subreddit">
				<div class="col-xs-12">
					<a href="{{data.subreddit}}"><small>{{data.subreddit}}</small></a>
					<small><span class="glyphicon glyphicon-arrow-up"></span> {{data.ups}}</small>
					<small><span class="glyphicon glyphicon-comment"></span></a>{{data.num_comments}}</small>
				</div>
			</div>
		</div>
	</div>
	
 </script>

 {% endraw %}

<script id="source" language="javascript" type="text/javascript">

// ---- Handlebars Helpers

Handlebars.registerHelper("formatTitle", function(data){
	var textlimit = 60;
	return (data.title.length > textlimit) ? data.title.substring(0, textlimit) + "..." : data.title;
});


Handlebars.registerHelper("picHelper", function(data){
	if ('preview' in data && data['preview']['images'][0]['resolutions'].length > 1) {
		cols[data.col] += data['preview']['images'][0]['resolutions'][1]['height'];
		return data['preview']['images'][0]['resolutions'][1]['url'];
	} else {
		cols[data.col] += 105;
		return data['thumbnail']['url'];
	}
});

// ----  Document Ready

$(document).ready(function() { 

	subs = [];
	{% if sub is defined %}
		sub = '{{sub}}';
	{% else %}
		sub = null;
	{% endif %}
	after = null;
	count = 0;
	limit = 40;
	sort = "hot";
	cols = {'col-1':0, 'col-2':0, 'col-3':0, 'col-4':0}
	getItems(sub, sort);
});
</script>

<script src="/static/functions.js"></script>
<script src="/static/events.js"></script>