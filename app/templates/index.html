<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
		<link rel="stylesheet" href="/static/style.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
		<script src="/static/handlebars-v2.0.0.js"></script>
		<script src="/static/jquery.visible.min.js"></script>
	</head>
	<body>
		<div id="main" class="container-fluid">
			<div class="row">
				<div id="left-menu" class="col-xs-2 affix-top">
					
					<div class="row menu-top">
					 	<div class="col-xs-12 sub-pg">
							Browsing <strong>r/{{sub}}</strong>
						</div>
						<div class="col-xs-12 link-pg">
							Browsing a shared gallery
						</div>
						<div class="col-xs-12 sub-pg link-pg">
							<a href="/">Back to main page</a>
						</div>
						<div class="col-xs-12 main-pg">
							Enter a subreddit below and it will be added to the gallery</a>
						</div>
					</div>
					 <div class="row main-pg">
					 	<div class="col-xs-12">
							<input type="input" class="form-control" id="input-sub" placeholder="Enter a Subreddit">
						</div>
					 </div>
					 <div class="row main-pg link-pg">
					 	<div id="sub-list" class="col-xs-12">
						</div>
					 </div>
					 <div class="row">
						<div class="col-xs-12">
							<select id="select-sort" class="form-control">
							    <option selected="selected" disabled>Sort by:</option>
							    <option value="hot">hot</option>
							    <option value="new">new</option>
							    <option value="day">top today</option>
							    <option value="week">top this week</option>
							    <option value="month">top this month</option>
							    <option value="year">top this year</option>]
							    <option value="all">top all time</option>
							</select>
						</div>
					</div>
					<br /> <br />
					<div class="row main-pg">
						<div class="menuitem col-xs-12 text-center">
							<button id="share" type="button" class="btn btn-default">Share this Gallery</button>
						</div>
					</div>
					<div class="row">
						<div class="menuitem col-xs-12 text-center">
							<img id='share-load' src='/static/images/ajax-loader.gif' />
							<input type="text" class="form-control" id="share-link">
						</div>
					</div>
				</div>
				<div id="gallery" class="col-xs-10">
					<div class="row">
						<div id="col-1-wrapper" class='col-xs-3 col'><div id='col-1'></div><div class='text-center load-button-wrapper'></div></div>
						<div id="col-2-wrapper" class='col-xs-3 col'><div id='col-2'></div><div class='text-center load-button-wrapper'></div></div>
						<div id="col-3-wrapper" class='col-xs-3 col'><div id='col-3'></div><div class='text-center load-button-wrapper'></div></div>
						<div id="col-4-wrapper" class='col-xs-3 col'><div id='col-4'></div><div class='text-center load-button-wrapper'></div></div>
					</div>
				</div>
			</div>
		</div>

		<!--Start Google Analytics-->

		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		  ga('create', 'UA-53022536-1', 'auto');
		  ga('require', 'displayfeatures');
		  ga('send', 'pageview');
		</script>
	</body>
</html>

{% raw %}

 <script id="simple-template" type="text/x-handlebars-template">
	<div class="picbox">
		<a style="{{thumbnailHelper}}" target="_blank" href="{{data.url}}"><img src="{{{picHelper data}}}" /></a>
		<div class="col-xs-12 {{data.display}}" >
			<div class="row">
				<div class="col-xs-12">
					<a id="extlink" href="http://www.reddit.com{{data.permalink}}" target="_blank">{{formatTitle data}}</a>
				</div>
			</div>
			<div class="row subreddit">
				<div class="col-xs-12">
					<a href="/r/{{data.subreddit}}"><small>{{data.subreddit}}</small></a>
					<small><span class="glyphicon glyphicon-arrow-up"></span> {{data.ups}}</small>
					<small><span class="glyphicon glyphicon-comment"></span></a>{{data.num_comments}}</small>
				</div>
			</div>
		</div>
	</div>
 </script>

 {% endraw %}

<script id="source" language="javascript" type="text/javascript">

// ---- Handlebars Helpers

Handlebars.registerHelper("formatTitle", function(data){
	return (data.title.length > options.text_limit) ? data.title.substring(0, options.text_limit) + "..." : data.title;
});

Handlebars.registerHelper("picHelper", function(data){
	if ('preview' in data && data['preview']['images'][0]['resolutions'].length > 1) {
		//cols[data.col] += data['preview']['images'][0]['resolutions'][1]['height'];
		return data['preview']['images'][0]['resolutions'][1]['url'];
	} else {
		//cols[data.col] += 105;
		return data['thumbnail'];
	}
});

$(document).ready(function() { 
	// User options
	options = {
		sort:"hot",
		limit: 80,
		text_limit: 60
	}
	// State variables
	state = {
		events: 1,
		after: null,
		count: 0,
	}
	// Determine which page the user is on
	{% if sub is defined %} 
		// Sub Page
		$(".sub-pg").show();
		sub = '{{sub}}'
	{% elif link is defined %} 
		// Shared link page
		$(".link-pg").show();
		sub = '{{link}}'
		subs = sub.split('+')
		for (var i in subs){
			addToSubList(subs[i]);
		}
	{% else %}
		// Regular page
		sub = null;
		if (readCookie('subsCookie') != null){
			// Read cookies
			subs = readCookie('subsCookie').split(',');
			for (var i in subs){
				addToSubList(subs[i]);
			}
			sub = subs.join('+');
		} else {
			subs = [];
		}
		$(".main-pg").show();
	{% endif %}
	// Run
	resize();
	getItems(sub);
	addLoadMoreButton();
});
</script>

<script src="/static/functions.js"></script>
<script src="/static/events.js"></script>
<script src="/static/cookies.js"></script>